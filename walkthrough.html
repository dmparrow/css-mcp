<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Arrow Stack Themer â€“ interactive walkthrough of design decisions and live pseudo-demo" />
  <title>Walkthrough Â· Arrow Stack Themer</title>
  <link rel="stylesheet" href="css/main.css" />
  <style>
    /* â”€â”€ Walkthrough layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .wt-shell {
      display: flex;
      align-items: flex-start;
      min-height: 100svh;
    }

    .wt-main {
      flex: 1;
      min-width: 0;
      padding-block: var(--space-8);
    }

    .wt-canvas {
      width: 340px;
      flex-shrink: 0;
      position: sticky;
      top: calc(var(--space-12) + var(--border-width-thin)); /* 1px accounts for header border-bottom */
      max-height: calc(100svh - var(--space-12) - var(--space-4));
      overflow-y: auto;
      padding: var(--space-4);
      border-left: var(--border-width-thin) solid var(--color-border-subtle);
      background-color: var(--color-bg-subtle);
    }

    @media (max-width: 900px) {
      .wt-shell { flex-direction: column-reverse; }
      .wt-canvas {
        width: 100%;
        position: static;
        max-height: none;
        border-left: none;
        border-bottom: var(--border-width-thin) solid var(--color-border-subtle);
      }
    }

    /* â”€â”€ Step cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .wt-step {
      border-left: var(--border-width-thick) solid var(--color-border-default);
      padding: var(--space-6);
      border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
      background-color: var(--color-surface-default);
      border-top: var(--border-width-thin) solid var(--color-border-subtle);
      border-right: var(--border-width-thin) solid var(--color-border-subtle);
      border-bottom: var(--border-width-thin) solid var(--color-border-subtle);
      transition: border-left-color var(--motion-duration-normal) var(--motion-easing-ease-out);
    }
    .wt-step[data-active] {
      border-left-color: var(--color-brand-default);
    }
    .wt-step-label {
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-semibold);
      letter-spacing: var(--letter-spacing-wider);
      text-transform: uppercase;
      color: var(--color-brand-default);
      margin-bottom: var(--space-1);
    }
    .wt-step-title {
      font-size: var(--font-size-xl);
      font-weight: var(--font-weight-bold);
      line-height: var(--line-height-tight);
      color: var(--color-text-primary);
      margin-bottom: var(--space-3);
    }
    .wt-step-why {
      font-size: var(--font-size-sm);
      color: var(--color-text-secondary);
      background-color: var(--color-surface-raised);
      border: var(--border-width-thin) solid var(--color-border-subtle);
      border-radius: var(--radius-md);
      padding: var(--space-3) var(--space-4);
      margin-bottom: var(--space-4);
    }
    .wt-step-why strong { color: var(--color-text-primary); }

    /* â”€â”€ Controls â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .wt-controls {
      display: flex;
      flex-direction: column;
      gap: var(--space-3);
    }
    .wt-control-row {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      flex-wrap: wrap;
    }
    .wt-control-label {
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-semibold);
      color: var(--color-text-muted);
      min-width: 11rem;
      font-family: var(--font-family-mono);
    }
    .wt-control-value {
      font-size: var(--font-size-xs);
      font-family: var(--font-family-mono);
      color: var(--color-text-secondary);
      min-width: 5rem;
    }
    input[type="color"] {
      width: 2.5rem;
      height: 2.5rem;
      padding: 0.1rem;
      border: var(--border-width-thin) solid var(--color-border-default);
      border-radius: var(--radius-md);
      background: var(--color-surface-default);
      cursor: pointer;
      flex-shrink: 0;
    }
    input[type="range"] {
      flex: 1;
      min-width: 8rem;
      max-width: 16rem;
      accent-color: var(--color-brand-default);
    }

    /* â”€â”€ Before/After comparison â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .wt-compare {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--space-3);
    }
    @media (max-width: 600px) { .wt-compare { grid-template-columns: 1fr; } }
    .wt-compare-pane {
      border-radius: var(--radius-md);
      padding: var(--space-3);
      font-size: var(--font-size-xs);
      font-family: var(--font-family-mono);
      line-height: var(--line-height-relaxed);
    }
    .wt-compare-pane[data-kind="before"] {
      background-color: var(--color-danger-subtle);
      border: var(--border-width-thin) solid var(--color-danger-default);
      color: var(--color-text-primary);
    }
    .wt-compare-pane[data-kind="after"] {
      background-color: var(--color-success-subtle);
      border: var(--border-width-thin) solid var(--color-success-default);
      color: var(--color-text-primary);
    }
    .wt-compare-heading {
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-bold);
      text-transform: uppercase;
      letter-spacing: var(--letter-spacing-widest);
      margin-bottom: var(--space-2);
    }
    .wt-compare-pane[data-kind="before"] .wt-compare-heading { color: var(--color-danger-default); }
    .wt-compare-pane[data-kind="after"]  .wt-compare-heading { color: var(--color-success-default); }
    .wt-cmt { color: var(--color-text-muted); }
    .wt-key { color: var(--color-brand-default); }
    .wt-val { color: var(--color-warning-default); }
    .wt-strike { text-decoration: line-through; opacity: 0.5; }

    /* â”€â”€ Architecture diagram â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .wt-arch {
      display: flex;
      flex-direction: column;
      gap: var(--space-2);
    }
    .wt-arch-row {
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }
    .wt-arch-box {
      border-radius: var(--radius-md);
      padding: var(--space-2) var(--space-3);
      font-size: var(--font-size-xs);
      font-family: var(--font-family-mono);
      font-weight: var(--font-weight-semibold);
      border: var(--border-width-medium) solid;
      text-align: center;
      min-width: 10rem;
    }
    .wt-arch-box[data-tier="write"] {
      background: var(--color-brand-subtle);
      border-color: var(--color-brand-default);
      color: var(--color-brand-emphasis);
    }
    .wt-arch-box[data-tier="derive"] {
      background: var(--color-warning-subtle);
      border-color: var(--color-warning-default);
      color: var(--color-text-primary);
    }
    .wt-arch-box[data-tier="read"] {
      background: var(--color-surface-raised);
      border-color: var(--color-border-default);
      color: var(--color-text-secondary);
      font-size: 0.65rem; /* intentionally smaller than --font-size-xs; used only for read-only tier labels */
    }
    .wt-arch-arrow {
      font-size: var(--font-size-md);
      color: var(--color-text-muted);
    }
    .wt-arch-note {
      font-size: var(--font-size-xs);
      color: var(--color-text-muted);
      font-style: italic;
      padding-left: var(--space-3);
    }

    /* â”€â”€ Motion demo animation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .wt-motion-ball {
      width: 3rem;
      height: 3rem;
      border-radius: var(--radius-full);
      background: var(--color-brand-default);
      transition: transform var(--motion-duration-normal) var(--motion-easing-ease-in-out);
      cursor: pointer;
      flex-shrink: 0;
    }
    .wt-motion-ball:hover { transform: translateX(6rem) scale(1.2); }
    .wt-motion-track {
      display: flex;
      align-items: center;
      background: var(--color-surface-inset);
      border-radius: var(--radius-xl);
      padding: var(--space-3);
      overflow: hidden;
      width: 100%;
      max-width: 18rem;
    }

    /* â”€â”€ Dark mode demo â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .wt-dm-compare {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--space-3);
    }
    @media (max-width: 600px) { .wt-dm-compare { grid-template-columns: 1fr; } }
    .wt-dm-pane {
      border-radius: var(--radius-lg);
      padding: var(--space-4);
      border: var(--border-width-thin) solid;
    }
    .wt-dm-pane[data-mode="light"] {
      background: #ffffff;
      border-color: #dee2e6;
      color: #212529;
    }
    .wt-dm-pane[data-mode="dark"] {
      background: #1a1d20;
      border-color: #495057;
      color: #f8f9fa;
    }
    .wt-dm-token {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: var(--space-1) 0;
      font-size: var(--font-size-xs);
      font-family: var(--font-family-mono);
      border-bottom: 1px solid;
    }
    .wt-dm-pane[data-mode="light"] .wt-dm-token { border-color: #dee2e6; }
    .wt-dm-pane[data-mode="dark"]  .wt-dm-token { border-color: #495057; }
    .wt-dm-swatch {
      width: 1.25rem;
      height: 1.25rem;
      border-radius: var(--radius-sm);
      border: 1px solid rgba(0,0,0,0.2);
      flex-shrink: 0;
    }
    .wt-dm-tag {
      font-size: 0.6rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      padding: 1px 5px;
      border-radius: 9999px;
    }
    .wt-dm-tag[data-kind="changes"] { background: #fff9db; color: #f08c00; border: 1px solid #f08c00; }
    .wt-dm-tag[data-kind="same"]    { background: #ebfbee; color: #2f9e44; border: 1px solid #2f9e44; }

    /* â”€â”€ Generated config panel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .wt-generated {
      background: var(--color-bg-emphasis);
      border-radius: var(--radius-md);
      padding: var(--space-3);
      font-size: var(--font-size-xs);
      font-family: var(--font-family-mono);
      line-height: var(--line-height-relaxed);
      color: var(--palette-neutral-200);
      overflow-x: auto;
      white-space: pre;
    }
    .gc-comment { color: #6c757d; }
    .gc-selector { color: #91a7ff; }
    .gc-key { color: #66d9e8; }
    .gc-val { color: #ffd43b; }
    .gc-semi { color: #6c757d; }

    /* â”€â”€ data-* demo â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .wt-attr-demo {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      flex-wrap: wrap;
    }
    .wt-attr-code {
      font-size: var(--font-size-xs);
      font-family: var(--font-family-mono);
      background: var(--color-surface-overlay);
      padding: var(--space-1) var(--space-2);
      border-radius: var(--radius-sm);
      border: var(--border-width-thin) solid var(--color-border-subtle);
      color: var(--color-text-primary);
    }

    /* â”€â”€ Live canvas components â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .wt-canvas-title {
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-bold);
      text-transform: uppercase;
      letter-spacing: var(--letter-spacing-widest);
      color: var(--color-text-muted);
      margin-bottom: var(--space-3);
    }

    /* â”€â”€ Section number pill â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .wt-num {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 1.5rem;
      height: 1.5rem;
      border-radius: var(--radius-full);
      background: var(--color-brand-default);
      color: var(--color-text-on-brand);
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-bold);
      flex-shrink: 0;
    }
  </style>
</head>

<body>

  <!-- â”€â”€ Site Header â”€â”€ -->
  <header class="c-site-header" role="banner">
    <div class="l-wrapper">
      <div class="c-site-header__inner">
        <a href="index.html" class="u-flex u-items-center u-gap-2 u-color-brand" style="text-decoration:none;">
          <svg width="24" height="24" viewBox="0 0 28 28" fill="none" aria-hidden="true">
            <rect width="28" height="28" rx="8" fill="currentColor"/>
            <path d="M8 20L14 8L20 20M10.5 16h7" stroke="white" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span class="u-font-bold u-color-primary">Arrow Stack Themer</span>
        </a>
        <nav class="c-nav u-bg-subtle u-rounded-full u-px-2 u-py-2" aria-label="Main navigation">
          <a class="c-nav__link" href="index.html">Components</a>
          <a class="c-nav__link" aria-current="page" data-active href="walkthrough.html">Walkthrough</a>
          <label for="theme-preset-select" class="u-visually-hidden">Theme preset</label>
          <select id="theme-preset-select" class="u-bg-brand-subtle u-border-subtle u-rounded-md u-px-2 u-py-2 u-text-sm u-color-primary" aria-label="Theme preset">
            <option value="ocean-teal">Ocean Teal</option>
            <option value="warm-sunset">Warm Sunset</option>
            <option value="mono-neutral">Mono Neutral</option>
            <option value="airy-serif">Airy Serif</option>
            <option value="compact-ui">Compact UI</option>
            <option value="midnight-calm">Midnight Calm</option>
          </select>
        </nav>
        <button class="c-button" data-variant="ghost" data-size="sm" onclick="toggleTheme()" aria-label="Toggle dark mode">
          <span id="theme-icon">ğŸŒ™</span> <span id="theme-label">Dark</span>
        </button>
      </div>
    </div>
  </header>

  <div class="wt-shell">

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         MAIN WALKTHROUGH CONTENT
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <main class="wt-main" id="walkthrough">
      <div class="l-wrapper" data-width="lg">
        <div class="l-stack" data-gap="xl">

          <!-- Intro -->
          <div class="l-stack" data-gap="md">
            <div class="l-cluster" data-gap="sm">
              <span class="c-badge" data-status="brand">Interactive</span>
              <span class="c-badge">6 design decisions</span>
              <span class="c-badge">Live demo</span>
            </div>
            <h1 class="u-text-4xl u-tracking-tight">Why we built it this way</h1>
            <p class="u-text-lg u-color-muted" style="max-width:52ch">
              Every architectural choice in Arrow Stack Themer answers one question:
              <em>how do we make theming as reliable and cheap as possible for AI agents?</em>
              This page explains each decision â€” and lets you play with the results live.
            </p>
            <div class="c-alert" role="status">
              <div class="c-alert__body">
                <p class="c-alert__title">This page is a live demo</p>
                <p class="c-alert__message">
                  Every control on the right panel and in each step edits the actual running
                  CSS custom properties. You're watching the theme engine work in real time â€”
                  including on this page's own nav, buttons, and cards.
                </p>
              </div>
            </div>
          </div>

          <!-- â”€â”€ Architecture overview â”€â”€ -->
          <div class="wt-step" id="step-arch">
            <p class="wt-step-label">Architecture</p>
            <h2 class="wt-step-title">The cascade: three tiers</h2>
            <div class="wt-step-why">
              <strong>Why layers?</strong> CSS Cascade Layers (<code>@layer</code>) give
              each tier a fixed specificity rank â€” without <code>!important</code>.
              Utilities always win over components; components always win over base styles.
              An agent writing to <code>config</code> can never accidentally be beaten by
              a component's internal default.
            </div>

            <div class="wt-arch">
              <div class="wt-arch-row">
                <div class="wt-arch-box" data-tier="write">
                  <div>âœï¸  css/theme.config.css</div>
                  <div style="font-weight:400;margin-top:2px">18 variables Â· agent write surface</div>
                </div>
                <span class="wt-arch-note">â† the ONLY file you edit</span>
              </div>
              <div class="wt-arch-row u-color-muted">
                <span class="wt-arch-arrow" style="margin-left:1.2rem">â†“  var() / calc()</span>
              </div>
              <div class="wt-arch-row">
                <div class="wt-arch-box" data-tier="derive">
                  <div>âš™ï¸  css/tokens.css</div>
                  <div style="font-weight:400;margin-top:2px">all semantic tokens derived here</div>
                </div>
                <span class="wt-arch-note">â† read-only, derived from config</span>
              </div>
              <div class="wt-arch-row u-color-muted">
                <span class="wt-arch-arrow" style="margin-left:1.2rem">â†“  consumed by</span>
              </div>
              <div class="wt-arch-row" style="gap:var(--space-2);flex-wrap:wrap">
                <div class="wt-arch-box" data-tier="read">base.css</div>
                <div class="wt-arch-box" data-tier="read">themes/light+dark.css</div>
                <div class="wt-arch-box" data-tier="read">layout.css</div>
                <div class="wt-arch-box" data-tier="read">components.css</div>
                <div class="wt-arch-box" data-tier="read">utilities.css</div>
              </div>
              <span class="wt-arch-note" style="margin-left:0">â† read-only infrastructure, never touched</span>
            </div>

            <div style="margin-top:var(--space-4)" class="l-stack" data-gap="sm">
              <p class="u-text-sm u-color-secondary">
                <strong>Layer declaration order in main.css:</strong>
              </p>
              <code style="display:block;background:var(--color-bg-emphasis);color:var(--palette-neutral-200);padding:var(--space-3);border-radius:var(--radius-md);font-size:var(--font-size-xs)">@layer config, tokens, base, themes, layout, components, utilities;</code>
              <p class="u-text-sm u-color-muted">
                Lower layers have lower specificity. <code>utilities</code> beats everything.
                <code>config</code> is read by <code>tokens</code> before any component runs.
              </p>
            </div>
          </div>

          <!-- â”€â”€ Before/After â”€â”€ -->
          <div class="wt-step" id="step-before-after">
            <p class="wt-step-label">The core problem</p>
            <h2 class="wt-step-title">From 200+ variables to 18</h2>
            <div class="wt-step-why">
              <strong>Before:</strong> agents had to read ~800 lines across 7 files to make
              a single brand change. Intermediate palette variables like
              <code>--palette-brand-400</code> were hardcoded in <code>dark.css</code>,
              meaning changing the brand color broke dark mode silently.
              <strong>After:</strong> 18 variables in one 78-line file. One edit = entire site.
            </div>

            <div class="wt-compare">
              <div class="wt-compare-pane" data-kind="before">
                <p class="wt-compare-heading">âŒ Before</p>
<span class="wt-cmt">/* tokens.css */</span>
<span class="wt-key wt-strike">--palette-brand-100</span>: <span class="wt-val">#dbe4ff</span>;
<span class="wt-key wt-strike">--palette-brand-300</span>: <span class="wt-val">#91a7ff</span>;
<span class="wt-key wt-strike">--palette-brand-400</span>: <span class="wt-val">#748ffc</span>;
<span class="wt-key wt-strike">--palette-brand-600</span>: <span class="wt-val">#4c6ef5</span>;
<span class="wt-key wt-strike">--palette-brand-700</span>: <span class="wt-val">#4263eb</span>;
<span class="wt-key wt-strike">--palette-brand-800</span>: <span class="wt-val">#3b5bdb</span>;
...
<span class="wt-cmt">/* dark.css â€“ hardcoded! */</span>
<span class="wt-key wt-strike">--color-brand-default</span>: <span class="wt-val">var(--palette-brand-<strong>400</strong>)</span>;
<span class="wt-cmt">/* â†‘ brand change won't follow here */</span>
              </div>
              <div class="wt-compare-pane" data-kind="after">
                <p class="wt-compare-heading">âœ… After</p>
<span class="wt-cmt">/* theme.config.css */</span>
<span class="wt-key">--cfg-brand</span>:        <span class="wt-val">#4c6ef5</span>;
<span class="wt-key">--cfg-brand-hover</span>:  <span class="wt-val">#4263eb</span>;
<span class="wt-key">--cfg-brand-active</span>: <span class="wt-val">#3b5bdb</span>;
<span class="wt-key">--cfg-brand-subtle</span>: <span class="wt-val">#dbe4ff</span>;
<span class="wt-key">--cfg-brand-on</span>:     <span class="wt-val">#ffffff</span>;

<span class="wt-cmt">/* tokens.css â€“ everything derives */</span>
<span class="wt-key">--color-brand-default</span>: <span class="wt-val">var(--cfg-brand)</span>;

<span class="wt-cmt">/* dark.css â€“ brand untouched âœ“ */</span>
<span class="wt-cmt">/* brand follows config in both modes */</span>
              </div>
            </div>
          </div>

          <!-- â”€â”€ Step 1: Brand â”€â”€ -->
          <div class="wt-step" id="step-brand">
            <div class="l-cluster u-items-center" data-gap="sm" style="margin-bottom:var(--space-2)">
              <span class="wt-num">1</span>
              <p class="wt-step-label" style="margin:0">Brand</p>
            </div>
            <h2 class="wt-step-title">One color picker â†’ entire brand system</h2>
            <div class="wt-step-why">
              <strong>Why 5 brand variables instead of 1?</strong>
              CSS can't reliably darken a color yet (<code>color-mix()</code> is new and
              inconsistent). Hover and active states need slightly different shades for
              contrast ratios to pass. We pre-declare all three stops so agents can verify
              WCAG contrast before writing, not after.
              <br><br>
              <strong>Why <code>--cfg-brand-subtle</code>?</strong>
              The light tint (used for badge/alert backgrounds) is very different in dark
              mode â€” it flips from <code>#dbe4ff</code> to <code>#1c2333</code>.
              <code>dark.css</code> overrides just this one variable; everything else
              (the main brand color) stays the same.
            </div>

            <div class="wt-controls">
              <div class="wt-control-row">
                <span class="wt-control-label">--cfg-brand</span>
                <input type="color" id="pick-brand" value="#4c6ef5" oninput="setBrand(this.value)" />
                <span class="wt-control-value" id="val-brand">#4c6ef5</span>
                <span class="u-text-xs u-color-muted">(hover &amp; active auto-computed)</span>
              </div>
              <div class="wt-control-row">
                <span class="wt-control-label">--cfg-brand-subtle</span>
                <input type="color" id="pick-subtle" value="#dbe4ff" oninput="setVar('--cfg-brand-subtle', this.value); updateGenerated()" />
                <span class="wt-control-value" id="val-subtle">#dbe4ff</span>
              </div>
              <div class="wt-control-row">
                <span class="wt-control-label">--cfg-brand-on</span>
                <input type="color" id="pick-on" value="#ffffff" oninput="setVar('--cfg-brand-on', this.value); updateGenerated()" />
                <span class="wt-control-value" id="val-on">#ffffff</span>
                <span class="u-text-xs u-color-muted">(text on filled buttons)</span>
              </div>
            </div>
            <p class="u-text-xs u-color-muted u-mt-4">
              âœ“ Affects live on this page: primary button, links, focus rings, active nav item, progress bar, badge (brand), input focus border
            </p>
          </div>

          <!-- â”€â”€ Step 2: Shape â”€â”€ -->
          <div class="wt-step" id="step-shape">
            <div class="l-cluster u-items-center" data-gap="sm" style="margin-bottom:var(--space-2)">
              <span class="wt-num">2</span>
              <p class="wt-step-label" style="margin:0">Shape</p>
            </div>
            <h2 class="wt-step-title">One radius slider â†’ coherent corners everywhere</h2>
            <div class="wt-step-why">
              <strong>Why <code>calc()</code> instead of 6 separate radius variables?</strong>
              If an agent sets 6 variables independently, values can drift â€” a card might
              be rounder than its button, breaking visual rhythm.
              With <code>--cfg-radius</code> as the single base:
              <code>--radius-sm = calc(var(--cfg-radius) Ã— 0.5)</code>,
              <code>--radius-lg = calc(var(--cfg-radius) Ã— 1.5)</code> etc.
              Every element stays proportional automatically. You can't break the scale.
            </div>

            <div class="wt-controls">
              <div class="wt-control-row">
                <span class="wt-control-label">--cfg-radius</span>
                <input type="range" id="range-radius" min="0" max="24" value="8"
                  step="1" oninput="setRadius(this.value)" />
                <span class="wt-control-value" id="val-radius">0.5rem</span>
              </div>
            </div>

            <div class="wt-compare" style="margin-top:var(--space-3)">
              <div class="wt-compare-pane" data-kind="before">
                <p class="wt-compare-heading">âŒ Old approach</p>
<span class="wt-cmt">/* 6 values to keep in sync */</span>
<span class="wt-key wt-strike">--radius-sm</span>:  <span class="wt-val">0.25rem</span>;
<span class="wt-key wt-strike">--radius-md</span>:  <span class="wt-val">0.5rem</span>;
<span class="wt-key wt-strike">--radius-lg</span>:  <span class="wt-val">0.75rem</span>;
<span class="wt-key wt-strike">--radius-xl</span>:  <span class="wt-val">1rem</span>;
<span class="wt-key wt-strike">--radius-2xl</span>: <span class="wt-val">1.5rem</span>;
<span class="wt-cmt">/* agent must update all 5 */</span>
              </div>
              <div class="wt-compare-pane" data-kind="after">
                <p class="wt-compare-heading">âœ… New approach</p>
<span class="wt-cmt">/* 1 value, rest derived */</span>
<span class="wt-key">--cfg-radius</span>: <span class="wt-val">0.5rem</span>;

<span class="wt-cmt">/* tokens.css auto-derives: */</span>
<span class="wt-key">--radius-sm</span>:  calc(<span class="wt-val">var(--cfg-radius) * 0.5</span>);
<span class="wt-key">--radius-md</span>:  <span class="wt-val">var(--cfg-radius)</span>;
<span class="wt-key">--radius-lg</span>:  calc(<span class="wt-val">var(--cfg-radius) * 1.5</span>);
<span class="wt-key">--radius-xl</span>:  calc(<span class="wt-val">var(--cfg-radius) * 2</span>);
              </div>
            </div>
            <p class="u-text-xs u-color-muted u-mt-4">
              âœ“ Affects live: all buttons, cards, inputs, badges, alerts, avatars, progress bars, dialogs
            </p>
          </div>

          <!-- â”€â”€ Step 3: Density â”€â”€ -->
          <div class="wt-step" id="step-density">
            <div class="l-cluster u-items-center" data-gap="sm" style="margin-bottom:var(--space-2)">
              <span class="wt-num">3</span>
              <p class="wt-step-label" style="margin:0">Density</p>
            </div>
            <h2 class="wt-step-title">One unit variable â†’ entire spacing scale</h2>
            <div class="wt-step-why">
              <strong>Why a single <code>--cfg-space-unit</code>?</strong>
              Same reasoning as radius: 13 spacing tokens derived from one base via
              <code>calc(N Ã— --cfg-space-unit)</code>.
              Drag the slider and watch every gap, padding, and section rhythm
              compress or expand in proportion â€” no values drift out of alignment.
              A dense enterprise dashboard vs an airy marketing page differ by exactly
              one token.
            </div>

            <div class="wt-controls">
              <div class="wt-control-row">
                <span class="wt-control-label">--cfg-space-unit</span>
                <input type="range" id="range-space" min="2" max="5" value="4"
                  step="0.5" oninput="setSpacing(this.value)" />
                <span class="wt-control-value" id="val-space">0.25rem</span>
              </div>
            </div>
            <p class="u-text-xs u-color-muted u-mt-4">
              âœ“ Affects live: all gaps, padding, section vertical rhythm (look at the spacing between these steps changing)
            </p>
          </div>

          <!-- â”€â”€ Step 4: Motion â”€â”€ -->
          <div class="wt-step" id="step-motion">
            <div class="l-cluster u-items-center" data-gap="sm" style="margin-bottom:var(--space-2)">
              <span class="wt-num">4</span>
              <p class="wt-step-label" style="margin:0">Motion</p>
            </div>
            <h2 class="wt-step-title">One speed variable â†’ all transitions</h2>
            <div class="wt-step-why">
              <strong>Why a single speed multiplier?</strong>
              <code>--motion-duration-fast = calc(--cfg-motion-speed Ã— 0.5)</code>,
              <code>slow = Ã— 2</code>, etc. The relative feel stays consistent regardless
              of the base speed.
              <strong>Setting it to 0ms removes all transitions instantly</strong> â€” useful
              for reduced-motion preferences or server-side rendering where animation
              isn't appropriate. No other changes needed.
            </div>

            <div class="wt-controls">
              <div class="wt-control-row">
                <span class="wt-control-label">--cfg-motion-speed</span>
                <input type="range" id="range-motion" min="0" max="600" value="200"
                  step="50" oninput="setMotion(this.value)" />
                <span class="wt-control-value" id="val-motion">200ms</span>
              </div>
            </div>

            <div style="margin-top:var(--space-4)">
              <p class="u-text-sm u-font-medium u-mb-2">Hover the ball to feel the current speed:</p>
              <div class="wt-motion-track">
                <div class="wt-motion-ball" title="Hover me!"></div>
              </div>
              <p class="u-text-xs u-color-muted u-mt-2">
                0ms = instant (accessibility). 200ms = default. 500ms = calm/deliberate.
              </p>
            </div>
            <p class="u-text-xs u-color-muted u-mt-4">
              âœ“ Affects live: hover on all buttons, nav links, focus states, the spinner animation
            </p>
          </div>

          <!-- â”€â”€ Step 5: Dark Mode â”€â”€ -->
          <div class="wt-step" id="step-dark">
            <div class="l-cluster u-items-center" data-gap="sm" style="margin-bottom:var(--space-2)">
              <span class="wt-num">5</span>
              <p class="wt-step-label" style="margin:0">Dark Mode</p>
            </div>
            <h2 class="wt-step-title">Only surfaces change â€” brand stays yours</h2>
            <div class="wt-step-why">
              <strong>Why does brand NOT change in dark mode?</strong>
              Brand color is identity â€” it shouldn't flip because the user prefers a dark
              background. Only surface tokens (backgrounds, borders, text colors) are
              overridden by <code>dark.css</code>. The brand color from
              <code>theme.config.css</code> flows through unchanged.
              This means an agent sets brand once and it works in both modes.
            </div>

            <!-- What changes vs what stays the same -->
            <div class="wt-dm-compare">
              <div class="wt-dm-pane" data-mode="light">
                <p class="u-text-xs u-font-bold" style="margin-bottom:var(--space-2);color:#495057">â˜€ï¸ Light mode</p>
                <div class="wt-dm-token" style="color:#212529">
                  <span>--color-bg-base</span>
                  <div style="display:flex;align-items:center;gap:4px">
                    <div class="wt-dm-swatch" style="background:#ffffff"></div>
                    <span class="wt-dm-tag" data-kind="changes">changes</span>
                  </div>
                </div>
                <div class="wt-dm-token" style="color:#212529">
                  <span>--color-text-primary</span>
                  <div style="display:flex;align-items:center;gap:4px">
                    <div class="wt-dm-swatch" style="background:#212529"></div>
                    <span class="wt-dm-tag" data-kind="changes">changes</span>
                  </div>
                </div>
                <div class="wt-dm-token" style="color:#212529">
                  <span>--color-border-default</span>
                  <div style="display:flex;align-items:center;gap:4px">
                    <div class="wt-dm-swatch" style="background:#dee2e6"></div>
                    <span class="wt-dm-tag" data-kind="changes">changes</span>
                  </div>
                </div>
                <div class="wt-dm-token" style="color:#212529;border-bottom:none">
                  <span>--cfg-brand</span>
                  <div style="display:flex;align-items:center;gap:4px">
                    <div class="wt-dm-swatch" id="dm-brand-light" style="background:#4c6ef5"></div>
                    <span class="wt-dm-tag" data-kind="same">same</span>
                  </div>
                </div>
              </div>
              <div class="wt-dm-pane" data-mode="dark">
                <p class="u-text-xs u-font-bold" style="margin-bottom:var(--space-2);color:#adb5bd">ğŸŒ™ Dark mode</p>
                <div class="wt-dm-token" style="color:#f8f9fa">
                  <span>--color-bg-base</span>
                  <div style="display:flex;align-items:center;gap:4px">
                    <div class="wt-dm-swatch" style="background:#0d0f10"></div>
                    <span class="wt-dm-tag" data-kind="changes">changes</span>
                  </div>
                </div>
                <div class="wt-dm-token" style="color:#f8f9fa">
                  <span>--color-text-primary</span>
                  <div style="display:flex;align-items:center;gap:4px">
                    <div class="wt-dm-swatch" style="background:#f8f9fa"></div>
                    <span class="wt-dm-tag" data-kind="changes">changes</span>
                  </div>
                </div>
                <div class="wt-dm-token" style="color:#f8f9fa">
                  <span>--color-border-default</span>
                  <div style="display:flex;align-items:center;gap:4px">
                    <div class="wt-dm-swatch" style="background:#495057"></div>
                    <span class="wt-dm-tag" data-kind="changes">changes</span>
                  </div>
                </div>
                <div class="wt-dm-token" style="color:#f8f9fa;border-bottom:none">
                  <span>--cfg-brand</span>
                  <div style="display:flex;align-items:center;gap:4px">
                    <div class="wt-dm-swatch" id="dm-brand-dark" style="background:#4c6ef5"></div>
                    <span class="wt-dm-tag" data-kind="same">same</span>
                  </div>
                </div>
              </div>
            </div>

            <div style="margin-top:var(--space-4)">
              <button class="c-button" data-variant="outline" onclick="toggleTheme()">
                Toggle dark mode on this page
              </button>
            </div>
          </div>

          <!-- â”€â”€ Step 6: data-* API â”€â”€ -->
          <div class="wt-step" id="step-data-api">
            <div class="l-cluster u-items-center" data-gap="sm" style="margin-bottom:var(--space-2)">
              <span class="wt-num">6</span>
              <p class="wt-step-label" style="margin:0">Component API</p>
            </div>
            <h2 class="wt-step-title"><code>data-*</code> attributes over class modifiers</h2>
            <div class="wt-step-why">
              <strong>Why <code>data-variant="danger"</code> instead of
              <code>class="c-button c-button--danger"</code>?</strong>
              Class modifiers force agents to juggle a class list â€” they must know the
              base class AND the modifier AND never duplicate.
              A <code>data-*</code> attribute is a key-value pair with one authoritative
              value per concern. Agents write less, make fewer mistakes, and the HTML is
              self-documenting: <em>this button is danger</em> is immediately readable.
            </div>

            <!-- Button variant demo -->
            <div class="l-stack" data-gap="md">
              <div>
                <p class="u-text-sm u-font-semibold u-mb-2">Button â€” cycle through variants:</p>
                <div class="l-cluster" data-gap="sm">
                  <button class="c-button" id="demo-btn" onclick="cycleVariant()">Click to cycle</button>
                </div>
                <p class="u-text-xs u-color-muted u-mt-2">
                  Current HTML: <code id="demo-btn-code" class="wt-attr-code">&lt;button class="c-button"&gt;</code>
                </p>
              </div>

              <div>
                <p class="u-text-sm u-font-semibold u-mb-2">Badge â€” cycle through status:</p>
                <div class="l-cluster" data-gap="sm">
                  <span class="c-badge" id="demo-badge" onclick="cycleBadge()" style="cursor:pointer">Click to cycle</span>
                </div>
                <p class="u-text-xs u-color-muted u-mt-2">
                  Current HTML: <code id="demo-badge-code" class="wt-attr-code">&lt;span class="c-badge"&gt;</code>
                </p>
              </div>

              <div>
                <p class="u-text-sm u-font-semibold u-mb-2">Alert â€” cycle through status:</p>
                <div class="c-alert" id="demo-alert" role="status" style="cursor:pointer" onclick="cycleAlert()">
                  <div class="c-alert__body">
                    <p class="c-alert__title" id="demo-alert-title">Default</p>
                    <p class="c-alert__message">Click to cycle through status variants</p>
                  </div>
                </div>
                <p class="u-text-xs u-color-muted u-mt-2">
                  Current HTML: <code id="demo-alert-code" class="wt-attr-code">&lt;div class="c-alert"&gt;</code>
                </p>
              </div>
            </div>

            <div class="wt-compare" style="margin-top:var(--space-4)">
              <div class="wt-compare-pane" data-kind="before">
                <p class="wt-compare-heading">âŒ Class modifier pattern</p>
<span class="wt-cmt">&lt;!-- must juggle base + modifier --&gt;</span>
&lt;button class="<span class="wt-val">c-button c-button--danger c-button--lg</span>"&gt;

<span class="wt-cmt">&lt;!-- to change: edit class list --&gt;</span>
<span class="wt-strike">c-button--danger</span>
â†’ add <span class="wt-val">c-button--outline</span>
              </div>
              <div class="wt-compare-pane" data-kind="after">
                <p class="wt-compare-heading">âœ… data-* attribute pattern</p>
<span class="wt-cmt">&lt;!-- each concern is a KV pair --&gt;</span>
&lt;button class="<span class="wt-val">c-button</span>"
  data-variant="<span class="wt-val">danger</span>"
  data-size="<span class="wt-val">lg</span>"&gt;

<span class="wt-cmt">&lt;!-- to change: one attribute --&gt;</span>
data-variant="<span class="wt-val">outline</span>"
              </div>
            </div>
          </div>

          <!-- â”€â”€ Summary â”€â”€ -->
          <div class="c-card" data-variant="elevated">
            <div class="c-card__header">
              <div class="l-cluster u-items-center" data-gap="sm">
                <span>ğŸ¯</span>
                <span>Six decisions, one goal</span>
              </div>
            </div>
            <div class="c-card__body">
              <div class="l-grid" data-min="sm" data-gap="sm">
                <div class="c-alert" role="status">
                  <div class="c-alert__body">
                    <p class="c-alert__title">Config layer</p>
                    <p class="c-alert__message">One file, 18 vars. Agents read once, write once.</p>
                  </div>
                </div>
                <div class="c-alert" role="status">
                  <div class="c-alert__body">
                    <p class="c-alert__title">calc() scales</p>
                    <p class="c-alert__message">Radius + spacing + motion can't drift. Guaranteed coherence.</p>
                  </div>
                </div>
                <div class="c-alert" role="status">
                  <div class="c-alert__body">
                    <p class="c-alert__title">Brand in config</p>
                    <p class="c-alert__message">Flows to light AND dark mode. Set once, works everywhere.</p>
                  </div>
                </div>
                <div class="c-alert" role="status">
                  <div class="c-alert__body">
                    <p class="c-alert__title">data-* API</p>
                    <p class="c-alert__message">One attribute per concern. No class juggling.</p>
                  </div>
                </div>
                <div class="c-alert" role="status">
                  <div class="c-alert__body">
                    <p class="c-alert__title">Cascade layers</p>
                    <p class="c-alert__message">Predictable override order. No !important anywhere.</p>
                  </div>
                </div>
                <div class="c-alert" role="status">
                  <div class="c-alert__body">
                    <p class="c-alert__title">AGENT_API.md</p>
                    <p class="c-alert__message">Full reference in one file. Fits a single context window.</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="c-card__footer">
              <div class="l-cluster u-justify-between">
                <a href="AGENT_API.md" class="c-button" data-variant="outline" data-size="sm">Open AGENT_API.md</a>
                <a href="index.html" class="c-button" data-size="sm">View all components â†’</a>
              </div>
            </div>
          </div>

        </div><!-- /l-stack -->
      </div><!-- /l-wrapper -->
    </main>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         RIGHT PANEL: LIVE CANVAS + GENERATED CONFIG
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <aside class="wt-canvas" aria-label="Live theme preview">
      <div class="l-stack" data-gap="md">

        <p class="wt-canvas-title">Live Canvas</p>

        <!-- Buttons -->
        <div class="l-stack" data-gap="xs">
          <p class="u-text-xs u-color-muted">Buttons</p>
          <div class="l-cluster" data-gap="xs">
            <button class="c-button" data-size="sm">Primary</button>
            <button class="c-button" data-variant="outline" data-size="sm">Outline</button>
            <button class="c-button" data-variant="ghost" data-size="sm">Ghost</button>
            <button class="c-button" data-variant="danger" data-size="sm">Danger</button>
          </div>
        </div>

        <!-- Badges -->
        <div class="l-stack" data-gap="xs">
          <p class="u-text-xs u-color-muted">Badges</p>
          <div class="l-cluster" data-gap="xs">
            <span class="c-badge" data-status="brand">Brand</span>
            <span class="c-badge" data-status="success">Success</span>
            <span class="c-badge" data-status="warning">Warning</span>
            <span class="c-badge" data-status="danger">Danger</span>
            <span class="c-badge" data-status="info">Info</span>
          </div>
        </div>

        <!-- Progress -->
        <div class="l-stack" data-gap="xs">
          <p class="u-text-xs u-color-muted">Progress</p>
          <div class="c-progress" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100" aria-label="70%">
            <div class="c-progress__bar" style="width:70%"></div>
          </div>
        </div>

        <!-- Nav -->
        <div class="l-stack" data-gap="xs">
          <p class="u-text-xs u-color-muted">Nav</p>
          <nav class="c-nav" data-orientation="vertical" aria-label="Demo nav">
            <a class="c-nav__link" aria-current="page" href="#">Active item</a>
            <a class="c-nav__link" href="#">Regular item</a>
          </nav>
        </div>

        <!-- Input -->
        <div class="l-stack" data-gap="xs">
          <p class="u-text-xs u-color-muted">Input</p>
          <div class="c-input">
            <label class="c-input__label" for="canvas-input">Focus to see ring</label>
            <input class="c-input__field" id="canvas-input" type="text" placeholder="Click to focusâ€¦" />
          </div>
        </div>

        <!-- Mini card -->
        <div class="l-stack" data-gap="xs">
          <p class="u-text-xs u-color-muted">Card</p>
          <article class="c-card">
            <div class="c-card__header">
              <div class="l-cluster u-justify-between">
                <span class="u-text-sm">Sample card</span>
                <span class="c-badge" data-status="success">Live</span>
              </div>
            </div>
            <div class="c-card__body">
              <p class="u-text-xs">Everything here responds to the controls.</p>
            </div>
            <div class="c-card__footer">
              <div class="l-cluster u-justify-end" data-gap="xs">
                <button class="c-button" data-variant="ghost" data-size="sm">Cancel</button>
                <button class="c-button" data-size="sm">Save</button>
              </div>
            </div>
          </article>
        </div>

        <!-- Divider -->
        <div class="c-divider" role="separator">Generated Config</div>

        <!-- Generated config output -->
        <div class="l-stack" data-gap="xs">
          <div class="l-cluster u-justify-between u-items-center">
            <p class="u-text-xs u-color-muted">css/theme.config.css</p>
            <button class="c-button" data-variant="ghost" data-size="sm" onclick="copyConfig()" id="copy-btn">Copy</button>
          </div>
          <div class="wt-generated" id="generated-config" aria-label="Generated theme config" role="region" aria-live="polite"></div>
        </div>

      </div>
    </aside>

  </div><!-- /wt-shell -->

  <script>
    const THEME_PRESETS = {
      'ocean-teal': {
        '--cfg-brand': '#0ea5a4',
        '--cfg-brand-hover': '#0b8f8e',
        '--cfg-brand-active': '#0a7a79',
        '--cfg-brand-subtle': '#e6fffb',
        '--cfg-brand-on': '#ffffff',
        '--cfg-success': '#2f9e44',
        '--cfg-success-subtle': '#ebfbee',
        '--cfg-warning': '#d97706',
        '--cfg-warning-subtle': '#fff7e6',
        '--cfg-danger': '#dc2626',
        '--cfg-danger-subtle': '#fff1f2',
        '--cfg-info': '#2563eb',
        '--cfg-info-subtle': '#eff6ff',
        '--cfg-radius': '0.75rem',
        '--cfg-font-sans': '"Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',
        '--cfg-font-mono': '"JetBrains Mono", ui-monospace, "Cascadia Code", "Source Code Pro", Menlo, Consolas, monospace',
        '--cfg-space-unit': '0.25rem',
        '--cfg-motion-speed': '180ms',
      },
      'warm-sunset': {
        '--cfg-brand': '#c2410c',
        '--cfg-brand-hover': '#9a3412',
        '--cfg-brand-active': '#7c2d12',
        '--cfg-brand-subtle': '#ffedd5',
        '--cfg-brand-on': '#ffffff',
        '--cfg-success': '#3f8f3f',
        '--cfg-success-subtle': '#edf7ed',
        '--cfg-warning': '#ca8a04',
        '--cfg-warning-subtle': '#fef9c3',
        '--cfg-danger': '#b91c1c',
        '--cfg-danger-subtle': '#fee2e2',
        '--cfg-info': '#0369a1',
        '--cfg-info-subtle': '#e0f2fe',
        '--cfg-radius': '0.6rem',
        '--cfg-font-sans': '"Inter", system-ui, sans-serif',
        '--cfg-font-mono': '"JetBrains Mono", ui-monospace, monospace',
        '--cfg-space-unit': '0.25rem',
        '--cfg-motion-speed': '180ms',
      },
      'mono-neutral': {
        '--cfg-brand': '#4b5563',
        '--cfg-brand-hover': '#374151',
        '--cfg-brand-active': '#1f2937',
        '--cfg-brand-subtle': '#f3f4f6',
        '--cfg-brand-on': '#ffffff',
        '--cfg-success': '#3f3f46',
        '--cfg-success-subtle': '#f4f4f5',
        '--cfg-warning': '#52525b',
        '--cfg-warning-subtle': '#f4f4f5',
        '--cfg-danger': '#27272a',
        '--cfg-danger-subtle': '#f5f5f5',
        '--cfg-info': '#52525b',
        '--cfg-info-subtle': '#f4f4f5',
        '--cfg-radius': '0.35rem',
        '--cfg-font-sans': '"IBM Plex Sans", system-ui, sans-serif',
        '--cfg-font-mono': '"IBM Plex Mono", ui-monospace, monospace',
        '--cfg-space-unit': '0.24rem',
        '--cfg-motion-speed': '140ms',
      },
      'airy-serif': {
        '--cfg-brand': '#6d28d9',
        '--cfg-brand-hover': '#5b21b6',
        '--cfg-brand-active': '#4c1d95',
        '--cfg-brand-subtle': '#f3e8ff',
        '--cfg-brand-on': '#ffffff',
        '--cfg-success': '#2b8a3e',
        '--cfg-success-subtle': '#ebfbee',
        '--cfg-warning': '#c17a00',
        '--cfg-warning-subtle': '#fff4d6',
        '--cfg-danger': '#c92a2a',
        '--cfg-danger-subtle': '#fff5f5',
        '--cfg-info': '#1864ab',
        '--cfg-info-subtle': '#e7f5ff',
        '--cfg-radius': '0.9rem',
        '--cfg-font-sans': '"Source Serif 4", Georgia, Cambria, "Times New Roman", serif',
        '--cfg-font-mono': '"IBM Plex Mono", ui-monospace, SFMono-Regular, Menlo, Consolas, monospace',
        '--cfg-space-unit': '0.3125rem',
        '--cfg-motion-speed': '220ms',
      },
      'compact-ui': {
        '--cfg-brand': '#0f766e',
        '--cfg-brand-hover': '#0d5f59',
        '--cfg-brand-active': '#0a4f4a',
        '--cfg-brand-subtle': '#ddfbf7',
        '--cfg-brand-on': '#ffffff',
        '--cfg-success': '#2f9e44',
        '--cfg-success-subtle': '#ebfbee',
        '--cfg-warning': '#d06b00',
        '--cfg-warning-subtle': '#fff4d6',
        '--cfg-danger': '#d6336c',
        '--cfg-danger-subtle': '#fff0f6',
        '--cfg-info': '#1c7ed6',
        '--cfg-info-subtle': '#e7f5ff',
        '--cfg-radius': '0.4rem',
        '--cfg-font-sans': '"Inter Tight", "Inter", system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',
        '--cfg-font-mono': '"JetBrains Mono", ui-monospace, "Cascadia Code", Menlo, Consolas, monospace',
        '--cfg-space-unit': '0.1875rem',
        '--cfg-motion-speed': '120ms',
      },
      'midnight-calm': {
        '--cfg-brand': '#4f46e5',
        '--cfg-brand-hover': '#4338ca',
        '--cfg-brand-active': '#3730a3',
        '--cfg-brand-subtle': '#e0e7ff',
        '--cfg-brand-on': '#ffffff',
        '--cfg-success': '#2b8a3e',
        '--cfg-success-subtle': '#ebfbee',
        '--cfg-warning': '#a16207',
        '--cfg-warning-subtle': '#fef9c3',
        '--cfg-danger': '#be123c',
        '--cfg-danger-subtle': '#ffe4e6',
        '--cfg-info': '#1d4ed8',
        '--cfg-info-subtle': '#dbeafe',
        '--cfg-radius': '0.65rem',
        '--cfg-font-sans': '"Avenir Next", "Segoe UI", "Inter", system-ui, sans-serif',
        '--cfg-font-mono': '"Fira Code", ui-monospace, SFMono-Regular, Menlo, Consolas, monospace',
        '--cfg-space-unit': '0.2813rem',
        '--cfg-motion-speed': '200ms',
      },
    };

    // â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const state = {
      brand:        '#0ea5a4',
      brandHover:   '#0b8f8e',
      brandActive:  '#0a7a79',
      brandSubtle:  '#e6fffb',
      brandOn:      '#ffffff',
      success:      '#2f9e44',
      successSubtle:'#ebfbee',
      warning:      '#d97706',
      warningSubtle:'#fff7e6',
      danger:       '#dc2626',
      dangerSubtle: '#fff1f2',
      info:         '#2563eb',
      infoSubtle:   '#eff6ff',
      radius:       '0.75rem',
      spaceUnit:    '0.25rem',
      motionSpeed:  '180ms',
    };

    function applyThemePreset(name) {
      const presetName = THEME_PRESETS[name] ? name : 'ocean-teal';
      const preset = THEME_PRESETS[presetName];
      Object.entries(preset).forEach(([token, value]) => {
        setVar(token, value);
      });

      state.brand = preset['--cfg-brand'];
      state.brandHover = preset['--cfg-brand-hover'];
      state.brandActive = preset['--cfg-brand-active'];
      state.brandSubtle = preset['--cfg-brand-subtle'];
      state.brandOn = preset['--cfg-brand-on'];
      state.success = preset['--cfg-success'];
      state.successSubtle = preset['--cfg-success-subtle'];
      state.warning = preset['--cfg-warning'];
      state.warningSubtle = preset['--cfg-warning-subtle'];
      state.danger = preset['--cfg-danger'];
      state.dangerSubtle = preset['--cfg-danger-subtle'];
      state.info = preset['--cfg-info'];
      state.infoSubtle = preset['--cfg-info-subtle'];
      state.radius = preset['--cfg-radius'];
      state.spaceUnit = preset['--cfg-space-unit'];
      state.motionSpeed = preset['--cfg-motion-speed'];

      const brandPicker = document.getElementById('pick-brand');
      const subtlePicker = document.getElementById('pick-subtle');
      const onPicker = document.getElementById('pick-on');
      if (brandPicker) brandPicker.value = state.brand;
      if (subtlePicker) subtlePicker.value = state.brandSubtle;
      if (onPicker) onPicker.value = state.brandOn;

      const radiusControl = document.getElementById('radius-range');
      const spacingControl = document.getElementById('space-range');
      const motionControl = document.getElementById('motion-range');
      if (radiusControl) radiusControl.value = Math.round(parseFloat(state.radius) * 16);
      if (spacingControl) spacingControl.value = (parseFloat(state.spaceUnit) / 0.0625).toFixed(1);
      if (motionControl) motionControl.value = parseInt(state.motionSpeed, 10);

      document.getElementById('val-brand').textContent = state.brand;
      document.getElementById('val-subtle').textContent = state.brandSubtle;
      document.getElementById('val-on').textContent = state.brandOn;
      document.getElementById('val-radius').textContent = state.radius;
      document.getElementById('val-space').textContent = state.spaceUnit;
      document.getElementById('val-motion').textContent = state.motionSpeed;

      const dmLight = document.getElementById('dm-brand-light');
      const dmDark = document.getElementById('dm-brand-dark');
      if (dmLight) dmLight.style.background = state.brand;
      if (dmDark) dmDark.style.background = state.brand;

      localStorage.setItem('ast:theme-preset', presetName);
      updateGenerated();
    }

    // â”€â”€ Utilities â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function setVar(name, value) {
      document.documentElement.style.setProperty(name, value);
    }

    function hexToRgb(hex) {
      const n = parseInt(hex.replace('#',''), 16);
      return [(n >> 16) & 255, (n >> 8) & 255, n & 255];
    }

    function toHex(r, g, b) {
      return '#' + [r,g,b].map(v => Math.max(0,Math.min(255,v)).toString(16).padStart(2,'0')).join('');
    }

    function darken(hex, pct) {
      const [r,g,b] = hexToRgb(hex);
      return toHex(Math.round(r*(1-pct)), Math.round(g*(1-pct)), Math.round(b*(1-pct)));
    }

    function lighten(hex, pct) {
      const [r,g,b] = hexToRgb(hex);
      return toHex(Math.round(r+(255-r)*pct), Math.round(g+(255-g)*pct), Math.round(b+(255-b)*pct));
    }

    // â”€â”€ Brand â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function setBrand(hex) {
      state.brand       = hex;
      state.brandHover  = darken(hex, 0.12);
      state.brandActive = darken(hex, 0.22);
      // Only auto-update subtle if it's close to the default blue tint
      state.brandSubtle = lighten(hex, 0.80);

      setVar('--cfg-brand',        state.brand);
      setVar('--cfg-brand-hover',  state.brandHover);
      setVar('--cfg-brand-active', state.brandActive);
      setVar('--cfg-brand-subtle', state.brandSubtle);

      document.getElementById('val-brand').textContent = hex;
      document.getElementById('pick-subtle').value = state.brandSubtle;
      document.getElementById('val-subtle').textContent = state.brandSubtle;

      // Update dark-mode brand swatches
      document.getElementById('dm-brand-light').style.background = hex;
      document.getElementById('dm-brand-dark').style.background  = hex;

      updateGenerated();
    }

    // â”€â”€ Radius â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function setRadius(px) {
      const rem = (px / 16).toFixed(4).replace(/\.?0+$/, '') + 'rem';
      state.radius = rem === '0rem' ? '0' : rem;
      setVar('--cfg-radius', state.radius);
      document.getElementById('val-radius').textContent = state.radius;
      updateGenerated();
    }

    // â”€â”€ Spacing â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function setSpacing(tenths) {
      // Slider range: min=2, max=5, step=0.5. Maps to 0.125rem â†’ 0.3125rem.
      // Formula: tenths Ã— 0.0625 = rem value (e.g. 4 Ã— 0.0625 = 0.25rem default)
      const val = (parseFloat(tenths) * 0.0625).toFixed(4);
      const display = parseFloat(val).toString() + 'rem';
      state.spaceUnit = display;
      setVar('--cfg-space-unit', display);
      document.getElementById('val-space').textContent = display;
      updateGenerated();
    }

    // â”€â”€ Motion â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function setMotion(ms) {
      state.motionSpeed = ms + 'ms';
      setVar('--cfg-motion-speed', state.motionSpeed);
      document.getElementById('val-motion').textContent = state.motionSpeed;
      updateGenerated();
    }

    // â”€â”€ Theme toggle â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function toggleTheme() {
      const root = document.documentElement;
      const isDark = root.getAttribute('data-theme') === 'dark';
      root.setAttribute('data-theme', isDark ? 'light' : 'dark');
      document.getElementById('theme-icon').textContent  = isDark ? 'ğŸŒ™' : 'â˜€ï¸';
      document.getElementById('theme-label').textContent = isDark ? 'Dark' : 'Light';
    }

    // â”€â”€ Component cycling demos â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const btnVariants = [
      { variant: null,      size: null,  label: 'Primary (default)' },
      { variant: 'outline', size: null,  label: 'Outline' },
      { variant: 'ghost',   size: null,  label: 'Ghost' },
      { variant: 'danger',  size: null,  label: 'Danger' },
      { variant: null,      size: 'sm',  label: 'Small' },
      { variant: null,      size: 'lg',  label: 'Large' },
    ];
    let btnIdx = 0;

    function cycleVariant() {
      btnIdx = (btnIdx + 1) % btnVariants.length;
      const { variant, size, label } = btnVariants[btnIdx];
      const btn = document.getElementById('demo-btn');
      btn.textContent = label;
      if (variant) btn.setAttribute('data-variant', variant);
      else btn.removeAttribute('data-variant');
      if (size) btn.setAttribute('data-size', size);
      else btn.removeAttribute('data-size');
      let code = '&lt;button class="c-button"';
      if (variant) code += ` data-variant="${variant}"`;
      if (size) code += ` data-size="${size}"`;
      code += '&gt;';
      document.getElementById('demo-btn-code').innerHTML = code;
    }

    const badgeStatuses = [null, 'brand', 'success', 'warning', 'danger', 'info'];
    const badgeLabels   = ['Default', 'Brand', 'Success', 'Warning', 'Danger', 'Info'];
    let badgeIdx = 0;

    function cycleBadge() {
      badgeIdx = (badgeIdx + 1) % badgeStatuses.length;
      const status = badgeStatuses[badgeIdx];
      const badge = document.getElementById('demo-badge');
      badge.textContent = badgeLabels[badgeIdx];
      if (status) badge.setAttribute('data-status', status);
      else badge.removeAttribute('data-status');
      let code = '&lt;span class="c-badge"';
      if (status) code += ` data-status="${status}"`;
      code += '&gt;';
      document.getElementById('demo-badge-code').innerHTML = code;
    }

    const alertStatuses = [null, 'success', 'warning', 'danger', 'info'];
    const alertTitles   = ['Default', 'Success', 'Warning', 'Danger', 'Info'];
    let alertIdx = 0;

    function cycleAlert() {
      alertIdx = (alertIdx + 1) % alertStatuses.length;
      const status = alertStatuses[alertIdx];
      const alert = document.getElementById('demo-alert');
      document.getElementById('demo-alert-title').textContent = alertTitles[alertIdx];
      if (status) alert.setAttribute('data-status', status);
      else alert.removeAttribute('data-status');
      let code = '&lt;div class="c-alert"';
      if (status) code += ` data-status="${status}"`;
      code += '&gt;';
      document.getElementById('demo-alert-code').innerHTML = code;
    }

    // â”€â”€ Generated config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function esc(s) { return s.replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

    function line(key, val, comment) {
      return `  <span class="gc-key">${key}</span>: <span class="gc-val">${val}</span><span class="gc-semi">;</span>${comment ? `   <span class="gc-comment">/* ${comment} */</span>` : ''}\n`;
    }

    function updateGenerated() {
      const el = document.getElementById('generated-config');
      const brand = document.getElementById('pick-brand').value;
      const subtle = document.getElementById('pick-subtle').value;
      const on = document.getElementById('pick-on').value;
      const hover = darken(brand, 0.12);
      const active = darken(brand, 0.22);

      el.innerHTML =
        `<span class="gc-selector">:root</span> {\n\n` +
        `  <span class="gc-comment">/* Brand */</span>\n` +
        line('--cfg-brand',        brand,  'primary') +
        line('--cfg-brand-hover',  hover,  ':hover') +
        line('--cfg-brand-active', active, ':active') +
        line('--cfg-brand-subtle', subtle, 'tint bg') +
        line('--cfg-brand-on',     on,     'text on brand') +
        `\n  <span class="gc-comment">/* Status */</span>\n` +
        line('--cfg-success',        '#2f9e44', '') +
        line('--cfg-success-subtle', '#ebfbee', '') +
        line('--cfg-warning',        '#f08c00', '') +
        line('--cfg-warning-subtle', '#fff9db', '') +
        line('--cfg-danger',         '#e03131', '') +
        line('--cfg-danger-subtle',  '#fff5f5', '') +
        line('--cfg-info',           '#1098ad', '') +
        line('--cfg-info-subtle',    '#e3fafc', '') +
        `\n  <span class="gc-comment">/* Shape Â· Density Â· Motion */</span>\n` +
        line('--cfg-radius',       document.getElementById('val-radius').textContent, '') +
        line('--cfg-space-unit',   document.getElementById('val-space').textContent, '') +
        line('--cfg-motion-speed', document.getElementById('val-motion').textContent, '') +
        `\n}`;
    }

    // â”€â”€ Copy config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function copyConfig() {
      const el = document.getElementById('generated-config');
      const plain = el.textContent.replace(/\s+/g, ' ').trim();
      navigator.clipboard.writeText(plain).then(() => {
        const btn = document.getElementById('copy-btn');
        btn.textContent = 'Copied!';
        setTimeout(() => { btn.textContent = 'Copy'; }, 2000);
      });
    }

    // â”€â”€ Intersection observer: highlight active step â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const steps = document.querySelectorAll('.wt-step');
    const observer = new IntersectionObserver(entries => {
      entries.forEach(e => {
        if (e.isIntersecting) e.target.setAttribute('data-active','');
        else e.target.removeAttribute('data-active');
      });
    }, { threshold: 0.25 });
    steps.forEach(s => observer.observe(s));

    // â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const presetSelect = document.getElementById('theme-preset-select');
    const savedPreset = localStorage.getItem('ast:theme-preset') || 'ocean-teal';
    if (presetSelect) {
      presetSelect.value = savedPreset;
      presetSelect.addEventListener('change', event => {
        applyThemePreset(event.target.value);
      });
    }
    applyThemePreset(savedPreset);
    updateGenerated();
  </script>

</body>
</html>
